with

------------------------------
-- this part lists all auctions on Base that happened in the accounting week of
-- March 4-11, 2025, and included either of the following orders:
--   0x3971adfb215a6174115a977b1d8915466699c1bc17c493c548971668b1780653bebe59328bd8b0b2879a6b897592e6190773c09567cfd4b2, or
--   0x3c8a1b22e804935157767226acf931dc7443b5df4d98b4ee1a1a3017c90d0b51711429b3fdf0e76cf7288e8e4078dfdc5366026467d39719
block_range_march_4_11_2025 as (
    select
        min("number") as start_block,
        max("number") as end_block
    from base.blocks
    where time >= cast('2025-03-04 00:00:00' as timestamp) and time < cast('2025-03-11 00:00:00' as timestamp)
),

base_march_4_11_auctions_prelim as (
    select
        'base' as blockchain,
        environment,
        auction_id
    from "query_4364122(blockchain='base')"
    where block_number >= (select start_block from block_range_march_4_11_2025) and block_number <= (select end_block from block_range_march_4_11_2025) and (
        order_uid = 0x3971adfb215a6174115a977b1d8915466699c1bc17c493c548971668b1780653bebe59328bd8b0b2879a6b897592e6190773c09567cfd4b2
        or
        order_uid = 0x3c8a1b22e804935157767226acf931dc7443b5df4d98b4ee1a1a3017c90d0b51711429b3fdf0e76cf7288e8e4078dfdc5366026467d39719
    )
),

base_march_4_11_auctions_final as (
    select
        *,
        0 as multiplier
    from base_march_4_11_auctions_prelim
),

mainnet_auction_ids as (
    select *
    from unnest (array[
        11774697,
        11774702,
        11774703,
        11774704,
        11774705,
        11774706,
        11774708,
        11774709,
        11774710,
        11774711,
        11774714,
        11774715,
        11774716,
        11774718,
        11774735,
        11774736,
        11774739,
        11774741,
        11774743,
        11774745,
        11774747,
        11774748,
        11774750,
        11774758,
        11774769,
        11774774,
        11774788,
        11774798,
        11774801,
        11775173,
        11775196,
        11775197,
        11775201,
        11775207,
        11775221,
        11775227,
        11775228,
        11775232,
        11775233,
        11775234,
        11775235,
        11775238,
        11775251,
        11775263,
        11775651,
        11775661,
        11775666,
        11775679,
        11775683,
        11775731,
        11775736,
        11775738,
        11775746,
        11775748
    ]) as t(auction_id)
),

mainnet_nov_18_25_2025_auctions as (
    select
        'ethereum' as blockchain,
        'prod' as environment,
        0 as multiplier,
        auction_id
    from mainnet_auction_ids
),

base_auction_ids as (
    select *
    from unnest (array[
        26267414,
        26267417,
        26267418,
        26267420,
        26267421,
        26267423,
        26267424,
        26267426,
        26267427,
        26267428,
        26267429,
        26267430,
        26267431,
        26267432,
        26267433,
        26267434,
        26267435,
        26267436,
        26267437,
        26267438,
        26267439,
        26267441,
        26267442,
        26267443,
        26267444,
        26267445,
        26267446,
        26267449,
        26267450,
        26267452,
        26267453,
        26267454,
        26267455,
        26267456,
        26267459,
        26267460,
        26267462,
        26267463,
        26267464,
        26267468,
        26267469,
        26267474,
        26267485,
        26267487,
        26267488,
        26267489,
        26267492,
        26267493,
        26267495,
        26267497,
        26267500,
        26267503,
        26267504,
        26267505
    ]) as t(auction_id)
),

base_nov25_dec2_2025_auctions as (
    select
        'base' as blockchain,
        'prod' as environment,
        0 as multiplier,
        auction_id
    from base_auction_ids
),

mainnet_auctions_ids_dec2_9_2025 as (
    select *
    from unnest (array[
        11854671
        ,11854676
        ,11854678
        ,11854680
        ,11854681
        ,11854693
        ,11854694
        ,11854696
        ,11854703
        ,11854704
        ,11854705
        ,11854708
        ,11854709
        ,11854711
        ,11854713
        ,11854716
        ,11854717
        ,11854722
        ,11854736
        ,11854740
        ,11854749
        ,11854753
        ,11854754
        ,11854756
        ,11854757
        ,11854758
        ,11854759
        ,11854760
        ,11854761
        ,11854762
        ,11854763
        ,11854764
        ,11854765
        ,11854766
        ,11854767
        ,11854768
        ,11854770
        ,11854771
        ,11854772
        ,11854773
        ,11854774
        ,11854775
        ,11854776
        ,11854777
        ,11854779
        ,11854780
        ,11854781
        ,11854782
        ,11854784
        ,11854785
        ,11854786
        ,11854787
        ,11854788
        ,11854789
        ,11854795
        ,11854802
        ,11854803
        ,11854804
        ,11854805
        ,11854808
        ,11854809
        ,11854810
        ,11854811
        ,11854812
        ,11854813
        ,11854814
        ,11854815
        ,11854816
        ,11854817
        ,11854818
        ,11854819
        ,11854820
        ,11854821
        ,11854822
        ,11854823
        ,11854824
        ,11854825
        ,11854826
        ,11854827
        ,11854828
        ,11854829
        ,11854830
        ,11854831
        ,11854832
        ,11854833
        ,11854834
        ,11854835
        ,11854836
        ,11854837
        ,11854838
        ,11854839
        ,11854840
        ,11854841
        ,11854842
        ,11854843
        ,11854846
        ,11854847
        ,11854848
        ,11854849
        ,11854850
        ,11854851
        ,11854876
        ,11854878
        ,11854879
        ,11854880
        ,11854881
        ,11854882
        ,11854884
        ,11854885
        ,11854886
        ,11854887
        ,11854888
        ,11854889
        ,11854890
        ,11854893
        ,11854895
        ,11854896
        ,11854897
        ,11854901
        ,11854914
        ,11854916
        ,11854917
        ,11854918
        ,11854919
        ,11854920
        ,11854922
        ,11854924
        ,11854925
        ,11854926
        ,11854927
        ,11854929
        ,11854930
        ,11854931
        ,11854932
        ,11854933
        ,11854934
        ,11854935
        ,11854937
        ,11854938
        ,11854946
        ,11854947
        ,11854948
        ,11854949
        ,11854952
        ,11854953
        ,11854954
        ,11854955
        ,11854956
        ,11854957
        ,11854959
        ,11854960
        ,11854961
        ,11854962
        ,11854963
        ,11854964
        ,11854965
        ,11854969
        ,11854979
        ,11854987
        ,11854995
        ,11854997
        ,11855003
        ,11855005
        ,11855006
        ,11855007
        ,11855008
        ,11855009
        ,11855010
        ,11855016
        ,11855018
        ,11855019
        ,11855020
        ,11855021
        ,11855022
        ,11855023
        ,11855024
        ,11855025
        ,11855027
        ,11855029
        ,11855030
        ,11855031
        ,11855032
        ,11855033
        ,11855035
        ,11855036
        ,11855037
        ,11855038
        ,11855079
        ,11855080
        ,11855082
        ,11855095
        ,11855135
        ,11855137
        ,11855138
        ,11855195
        ,11855238
        ,11855239
        ,11855242
        ,11855245
        ,11855246
        ,11855251
        ,11855282
        ,11855337
    ]) as t(auction_id)
),

ethereum_dec2_9_2025_auctions as (
    select
        'ethereum' as blockchain,
        'prod' as environment,
        0 as multiplier,
        auction_id
    from mainnet_auctions_ids_dec2_9_2025
),

gnosis_chain_prod_ids_dec16_2025 as (
    select *
    from unnest (array[
        14496475
        ,14496476
        ,14496477
        ,14496479
        ,14496480
        ,14496481
        ,14496483
        ,14496484
        ,14496485
        ,14496486
        ,14496487
        ,14496489
        ,14496490
        ,14496491
        ,14496492
        ,14496493
        ,14496494
        ,14496495
        ,14496496
        ,14496497
        ,14496499
        ,14496500
        ,14496504
        ,14496505
        ,14496506
        ,14496507
        ,14496508
        ,14496509
        ,14496510
        ,14496511
        ,14496512
        ,14496513
        ,14496516
        ,14496518
        ,14496519
        ,14496520
        ,14496522
        ,14496523
        ,14496524
        ,14496525
        ,14496526
        ,14496527
        ,14496528
        ,14496529
        ,14496530
        ,14496532
        ,14496533
        ,14496534
        ,14496535
        ,14496536
        ,14496537
        ,14496538
        ,14496539
        ,14496542
        ,14496543
        ,14496544
        ,14496545
        ,14496546
        ,14496548
        ,14496550
        ,14496551
        ,14496552
        ,14496553
        ,14496555
        ,14496556
        ,14496557
        ,14496558
        ,14496559
        ,14496561
        ,14496562
        ,14496564
        ,14496565
        ,14496566
        ,14496568
        ,14496569
        ,14496570
        ,14496571
        ,14496573
        ,14496574
        ,14496575
        ,14496577
        ,14496579
        ,14496580
        ,14496582
        ,14496583
        ,14496584
        ,14496585
        ,14496586
        ,14496587
        ,14496589
        ,14496591
        ,14496592
        ,14496593
        ,14496594
        ,14496596
        ,14496597
        ,14496598
        ,14496599
        ,14496600
        ,14496601
        ,14496602
        ,14496603
        ,14496604
        ,14496605
        ,14496606
        ,14496607
        ,14496608
        ,14496609
        ,14496610
        ,14496611
        ,14496612
        ,14496613
        ,14496614
        ,14496615
        ,14496616
        ,14496617
        ,14496618
        ,14496619
        ,14496620
        ,14496621
        ,14496622
        ,14496624
        ,14496625
        ,14496626
        ,14496627
        ,14496628
        ,14496629
        ,14496630
        ,14496631
        ,14496632
        ,14496633
        ,14496634
        ,14496636
        ,14496637
        ,14496638
        ,14496639
        ,14496640
        ,14496643
        ,14496644
        ,14496646
        ,14496647
        ,14496648
        ,14496649
        ,14496650
        ,14496651
        ,14496652
        ,14496653
        ,14496654
        ,14496655
        ,14496656
        ,14496657
        ,14496659
        ,14496660
        ,14496661
        ,14496662
        ,14496663
        ,14496664
        ,14496665
        ,14496666
        ,14496667
        ,14496668
        ,14496669
        ,14496671
        ,14496672
        ,14496673
        ,14496674
        ,14496675
        ,14496677
        ,14496678
        ,14496680
        ,14496682
        ,14496683
        ,14496685
        ,14496686
        ,14496687
        ,14496688
        ,14496689
        ,14496690
        ,14496691
        ,14496692
        ,14496694
        ,14496695
        ,14496696
        ,14496697
        ,14496698
        ,14496699
        ,14496700
        ,14496701
        ,14496702
        ,14496703
        ,14496704
        ,14496705
        ,14496706
        ,14496708
        ,14496709
        ,14496710
        ,14496711
        ,14496712
        ,14496713
        ,14496714
        ,14496715
        ,14496716
        ,14496717
        ,14496718
        ,14496719
        ,14496720
        ,14496722
        ,14496723
        ,14496725
        ,14496726
        ,14496727
        ,14496728
        ,14496729
        ,14496730
        ,14496731
        ,14496732
        ,14496733
        ,14496735
        ,14496736
        ,14496737
        ,14496738
        ,14496739
        ,14496740
        ,14496741
        ,14496742
        ,14496745
        ,14496746
        ,14496747
        ,14496748
        ,14496749
        ,14496750
        ,14496751
        ,14496752
        ,14496753
        ,14496754
        ,14496755
        ,14496756
        ,14496758
        ,14496759
        ,14496760
        ,14496761
        ,14496762
        ,14496763
        ,14496764
        ,14496765
        ,14496767
        ,14496769
        ,14496770
        ,14496771
        ,14496772
        ,14496773
        ,14496774
        ,14496777
        ,14496778
        ,14496779
        ,14496780
        ,14496782
        ,14496783
        ,14496785
        ,14496787
        ,14496788
        ,14496789
        ,14496790
        ,14496791
        ,14496792
        ,14496793
        ,14496794
        ,14496795
        ,14496796
        ,14496797
        ,14496798
        ,14496799
        ,14496801
        ,14496802
        ,14496803
        ,14496804
        ,14496805
        ,14496806
        ,14496807
        ,14496808
        ,14496809
        ,14496810
        ,14496811
        ,14496812
        ,14496813
        ,14496814
        ,14496815
        ,14496816
        ,14496817
        ,14496818
        ,14496819
        ,14496820
        ,14496822
        ,14496823
        ,14496824
        ,14496825
        ,14496826
        ,14496828
        ,14496829
        ,14496830
        ,14496831
        ,14496832
        ,14496833
        ,14496834
        ,14496835
        ,14496836
        ,14496837
        ,14496838
        ,14496839
        ,14496840
        ,14496841
        ,14496842
        ,14496843
        ,14496844
        ,14496845
        ,14496846
        ,14496847
        ,14496848
        ,14496849
        ,14496851
        ,14496852
        ,14496854
        ,14496855
        ,14496856
        ,14496857
        ,14496858
        ,14496859
        ,14496861
        ,14496862
        ,14496863
        ,14496864
        ,14496865
        ,14496866
        ,14496868
        ,14496869
        ,14496870
        ,14496871
        ,14496872
        ,14496873
        ,14496874
        ,14496875
        ,14496876
        ,14496877
        ,14496878
        ,14496879
        ,14496880
        ,14496881
        ,14496882
        ,14496886
        ,14496887
        ,14496888
        ,14496889
        ,14496890
        ,14496891
        ,14496892
        ,14496893
        ,14496895
        ,14496896
        ,14496897
        ,14496898
        ,14496899
        ,14496901
        ,14496902
        ,14496903
        ,14496904
        ,14496905
        ,14496906
        ,14496907
        ,14496908
        ,14496909
        ,14496910
        ,14496911
        ,14496912
        ,14496913
        ,14496914
        ,14496915
        ,14496916
        ,14496917
        ,14496918
        ,14496919
        ,14496920
        ,14496921
        ,14496922
        ,14496923
        ,14496924
        ,14496925
        ,14496926
        ,14496927
        ,14496928
        ,14496929
        ,14496930
        ,14496932
        ,14496965
        ,14496968
        ,14496969
        ,14496970
        ,14496971
        ,14496973
        ,14496974
        ,14496975
        ,14496976
        ,14496977
        ,14496978
        ,14496979
        ,14496980
        ,14496981
        ,14496982
        ,14496983
        ,14496984
        ,14496985
        ,14496986
        ,14496987
        ,14496988
        ,14496989
        ,14496990
        ,14496991
        ,14496992
        ,14496993
        ,14496994
        ,14496996
        ,14496997
        ,14496998
        ,14496999
        ,14497000
        ,14497001
        ,14497002
        ,14497003
        ,14497004
        ,14497005
        ,14497007
        ,14497008
        ,14497009
        ,14497011
        ,14497013
        ,14497014
        ,14497015
        ,14497016
        ,14497018
        ,14497019
        ,14497020
        ,14497021
        ,14497022
        ,14497023
        ,14497024
        ,14497025
        ,14497026
        ,14497028
        ,14497029
        ,14497032
        ,14497033
        ,14497034
        ,14497038
        ,14497039
        ,14497040
        ,14497041
        ,14497044
        ,14497045
        ,14497046
        ,14497047
        ,14497048
        ,14497050
        ,14497051
        ,14497052
        ,14497053
        ,14497054
        ,14497055
        ,14497056
        ,14497057
        ,14497058
        ,14497059
        ,14497060
        ,14497062
        ,14497063
        ,14497064
        ,14497067
        ,14497068
        ,14497070
        ,14497071
        ,14497073
        ,14497074
        ,14497077
        ,14497078
        ,14497079
        ,14497080
        ,14497081
        ,14497083
        ,14497084
        ,14497085
        ,14497088
        ,14497092
        ,14497094
        ,14497095
        ,14497096
        ,14497099
        ,14497100
        ,14497101
        ,14497102
        ,14497103
        ,14497104
        ,14497105
        ,14497107
        ,14497108
        ,14497109
        ,14497110
        ,14497111
        ,14497112
        ,14497113
        ,14497115
        ,14497116
        ,14497118
        ,14497120
        ,14497122
        ,14497124
        ,14497126
        ,14497128
        ,14497132
        ,14497134
        ,14497138
        ,14497142
        ,14497146
        ,14497150
        ,14497154
        ,14497158
        ,14497159
        ,14497162
        ,14497163
        ,14497165
        ,14497166
        ,14497167
        ,14497169
        ,14497170
        ,14497171
        ,14497172
        ,14497173
        ,14497174
        ,14497176
        ,14497177
        ,14497178
        ,14497180
        ,14497181
        ,14497183
        ,14497184
        ,14497186
        ,14497187
        ,14497188
        ,14497189
        ,14497190
        ,14497191
        ,14497192
        ,14497193
        ,14497195
        ,14497196
        ,14497198
        ,14497199
        ,14497200
        ,14497203
        ,14497204
        ,14497206
        ,14497207
        ,14497208
        ,14497209
        ,14497210
        ,14497211
        ,14497212
        ,14497213
        ,14497214
        ,14497215
        ,14497216
        ,14497217
        ,14497218
        ,14497219
        ,14497221
        ,14497222
        ,14497223
        ,14497224
        ,14497225
        ,14497229
        ,14497230
        ,14497232
        ,14497233
        ,14497234
        ,14497235
        ,14497240
        ,14497241
        ,14497244
        ,14497245
        ,14497246
        ,14497247
        ,14497249
        ,14497250
        ,14497251
        ,14497253
        ,14497254
        ,14497255
        ,14497256
        ,14497257
        ,14497259
        ,14497260
        ,14497261
        ,14497262
        ,14497263
        ,14497264
        ,14497267
        ,14497269
        ,14497271
        ,14497272
        ,14497275
        ,14497277
        ,14497278
        ,14497279
        ,14497280
        ,14497282
        ,14497283
        ,14497284
        ,14497285
        ,14497286
        ,14497289
        ,14497290
        ,14497291
        ,14497292
        ,14497293
        ,14497294
        ,14497295
        ,14497296
        ,14497298
        ,14497299
        ,14497300
        ,14497302
        ,14497303
        ,14497304
        ,14497306
        ,14497308
        ,14497309
        ,14497312
        ,14497313
        ,14497314
        ,14497315
        ,14497316
        ,14497318
        ,14497319
        ,14497320
        ,14497321
        ,14497323
        ,14497324
        ,14497325
        ,14497327
        ,14497329
        ,14497330
        ,14497331
        ,14497334
        ,14497335
        ,14497337
        ,14497339
        ,14497341
        ,14497342
        ,14497343
        ,14497344
        ,14497345
        ,14497346
        ,14497347
        ,14497348
        ,14497349
        ,14497350
        ,14497351
        ,14497352
        ,14497353
        ,14497354
        ,14497355
        ,14497356
        ,14497358
        ,14497359
        ,14497360
        ,14497362
        ,14497363
        ,14497364
        ,14497365
        ,14497366
        ,14497367
        ,14497368
        ,14497369
        ,14497370
        ,14497371
        ,14497372
        ,14497373
        ,14497374
        ,14497376
        ,14497377
        ,14497379
        ,14497380
        ,14497381
        ,14497383
        ,14497384
        ,14497385
        ,14497386
        ,14497387
        ,14497388
        ,14497389
        ,14497390
        ,14497391
        ,14497392
        ,14497393
        ,14497394
        ,14497395
        ,14497396
        ,14497397
        ,14497398
        ,14497399
        ,14497400
        ,14497401
        ,14497404
        ,14497406
        ,14497407
        ,14497408
        ,14497410
        ,14497411
        ,14497412
        ,14497413
        ,14497416
        ,14497417
        ,14497418
        ,14497419
        ,14497421
        ,14497422
        ,14497423
        ,14497424
        ,14497425
        ,14497426
        ,14497427
        ,14497428
        ,14497429
        ,14497430
        ,14497431
        ,14497432
        ,14497433
        ,14497434
        ,14497436
        ,14497437
        ,14497438
        ,14497439
        ,14497441
        ,14497442
        ,14497443
        ,14497444
        ,14497445
        ,14497446
        ,14497447
        ,14497448
        ,14497449
        ,14497451
        ,14497452
        ,14497453
        ,14497454
        ,14497455
        ,14497456
        ,14497457
        ,14497458
        ,14497459
        ,14497461
        ,14497463
        ,14497464
        ,14497465
        ,14497466
        ,14497467
        ,14497468
        ,14497469
        ,14497470
        ,14497471
        ,14497472
        ,14497473
        ,14497476
        ,14497477
        ,14497479
        ,14497481
        ,14497482
        ,14497483
        ,14497485
        ,14497486
        ,14497488
        ,14497493
        ,14497495
        ,14497496
        ,14497497
        ,14497498
        ,14497499
        ,14497501
        ,14497502
        ,14497503
        ,14497504
        ,14497505
        ,14497506
        ,14497507
        ,14497508
        ,14497509
        ,14497510
        ,14497511
        ,14497512
        ,14497513
        ,14497514
        ,14497515
        ,14497516
        ,14497517
        ,14497519
        ,14497520
        ,14497521
        ,14497522
        ,14497524
        ,14497525
        ,14497527
        ,14497528
        ,14497529
        ,14497530
        ,14497531
        ,14497532
        ,14497533
        ,14497534
        ,14497535
        ,14497536
        ,14497537
        ,14497538
        ,14497539
        ,14497540
        ,14497541
        ,14497542
        ,14497543
        ,14497545
        ,14497546
        ,14497547
        ,14497549
        ,14497550
        ,14497552
        ,14497553
        ,14497555
        ,14497557
        ,14497558
        ,14497559
        ,14497560
        ,14497561
        ,14497562
        ,14497563
        ,14497567
        ,14497568
        ,14497569
        ,14497570
        ,14497571
        ,14497573
        ,14497576
        ,14497577
        ,14497579
        ,14497581
        ,14497583
        ,14497584
        ,14497585
        ,14497586
        ,14497587
        ,14497588
        ,14497590
        ,14497592
        ,14497593
        ,14497594
        ,14497595
        ,14497597
        ,14497598
        ,14497599
        ,14497600
        ,14497601
        ,14497602
        ,14497603
        ,14497604
        ,14497605
        ,14497606
        ,14497607
        ,14497608
        ,14497614
        ,14497616
        ,14497617
        ,14497619
        ,14497637
        ,14497642
        ,14497691
    ]) as t(auction_id)
),

gnosis_dec16_auctions as (
    select
        'gnosis' as blockchain,
        'prod' as environment,
        0 as multiplier,
        auction_id
    from gnosis_chain_prod_ids_dec16_2025
)


------------------------------

-- select
--     bd.environment,
--     bd.auction_id,
--     ea.multiplier
-- from base_march_4_11_auctions_final as ea inner join "query_4351957(blockchain='{{blockchain}}')" as bd on ea.environment = bd.environment and ea.auction_id = bd.auction_id
-- union all
select distinct
    bd.environment,
    bd.auction_id,
    m.multiplier
from mainnet_nov_18_25_2025_auctions as m inner join "query_4351957(blockchain='{{blockchain}}')" as bd on m.environment = bd.environment and m.auction_id = bd.auction_id
where m.blockchain = '{{blockchain}}'
union all
select distinct
    bd.environment,
    bd.auction_id,
    m.multiplier
from base_nov25_dec2_2025_auctions as m inner join "query_4351957(blockchain='{{blockchain}}')" as bd on m.environment = bd.environment and m.auction_id = bd.auction_id
where m.blockchain = '{{blockchain}}'
union all
select distinct
    bd.environment,
    bd.auction_id,
    m.multiplier
from ethereum_dec2_9_2025_auctions as m inner join "query_4351957(blockchain='{{blockchain}}')" as bd on m.environment = bd.environment and m.auction_id = bd.auction_id
union all
select distinct
    bd.environment,
    bd.auction_id,
    m.multiplier
from gnosis_dec16_auctions as m inner join "query_4351957(blockchain='{{blockchain}}')" as bd on m.environment = bd.environment and m.auction_id = bd.auction_id
